<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>‡§Æ‡§π‡§æ‡§∞‡§æ‡§ú ‡§ú‡§®‡§∞‡§≤ ‡§∏‡•ç‡§ü‡•ã‡§∞</title>

  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }

    table {
      border-collapse: collapse;
      width: 80%;
      margin-top: 10px;
    }

    th, td {
      border: 1px solid #333;
      padding: 8px;
      text-align: left;
    }

    th { background-color: #f2f2f2; }

    .qty-btn {
      padding: 4px 8px;
      font-size: 14px;
      cursor: pointer;
      border-radius: 4px;
      border: 1px solid #ccc;
      background: #f7f7f7;
    }

    .qty-btn:hover {
      background: #eaeaea;
    }

    .qty-box {
      padding: 4px 10px;
      font-weight: bold;
    }

    /* ‚úÖ PROFESSIONAL REMOVE ICON */
    .remove-btn {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 16px;
      margin-left: 8px;
      color: #555;
    }

    .remove-btn:hover {
      color: #000;
      transform: scale(1.1);
    }

    .whatsapp-btn {
      background-color: #25d366;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      font-size: 15px;
      cursor: pointer;
      font-weight: bold;
    }

    #searchBox {
      padding: 8px;
      width: 220px;
      margin-bottom: 10px;
    }

    .cart-box {
      border: 2px dashed #25d366;
      padding: 12px;
      margin-top: 20px;
      width: 80%;
    }
  </style>

  <script>
    let cart = [];

    async function loadProducts() {
      const csvUrl =
        "https://docs.google.com/spreadsheets/d/1gUnQPlyJVKctXsGA2gshdUGJf1tmtVqAJQ_W1W-2nC8/export?format=csv";

      const response = await fetch(csvUrl);
      const csvText = await response.text();
      const lines = csvText.split("\n");

      const tbody = document.getElementById("product-table-body");
      tbody.innerHTML = "";

      for (let i = 1; i < lines.length; i++) {
        const cells = lines[i].split(",");

        if (cells.length >= 2 && cells[0].trim()) {
          const name = cells[0].trim();
          const price = parseFloat(cells[1].trim());

          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${name}</td>
            <td>‚Çπ ${price}</td>
            <td>
              <button class="qty-btn" onclick="changeQty('${name}', ${price}, -1)">‚àí</button>
              <span class="qty-box" id="qty-${name}">0</span>
              <button class="qty-btn" onclick="changeQty('${name}', ${price}, 1)">+</button>
            </td>
          `;
          tbody.appendChild(row);
        }
      }
    }

    function changeQty(name, price, delta) {
      let item = cart.find(p => p.name === name);

      if (!item && delta > 0) {
        cart.push({ name, price, qty: 1 });
      } else if (item) {
        item.qty += delta;
        if (item.qty <= 0) {
          cart = cart.filter(p => p.name !== name);
        }
      }

      updateQtyUI(name);
      renderCart();
    }

    function updateQtyUI(name) {
      const qtySpan = document.getElementById(`qty-${name}`);
      const item = cart.find(p => p.name === name);
      qtySpan.innerText = item ? item.qty : 0;
    }

    function renderCart() {
      const cartList = document.getElementById("cart-items");
      cartList.innerHTML = "";

      let total = 0;

      cart.forEach((item, index) => {
        const itemTotal = item.price * item.qty;
        total += itemTotal;

        const div = document.createElement("div");
        div.innerHTML = `
          ${item.name} √ó ${item.qty} = ‚Çπ${itemTotal}
          <button class="remove-btn" onclick="removeOne(${index})" title="Remove one">‚úï</button>
        `;
        cartList.appendChild(div);
      });

      document.getElementById("cart-total").innerText = total;
    }

    function removeOne(index) {
      cart[index].qty -= 1;

      if (cart[index].qty <= 0) {
        const name = cart[index].name;
        cart.splice(index, 1);
        updateQtyUI(name);
      } else {
        updateQtyUI(cart[index].name);
      }

      renderCart();
    }

    function placeOrderFromCart() {
      if (cart.length === 0) {
        alert("Cart is empty");
        return;
      }

      let message = "Hello, I want to order:\n\n";
      let total = 0;

      cart.forEach(item => {
        message += `${item.name} √ó ${item.qty} ‚Äì ‚Çπ${item.price * item.qty}\n`;
        total += item.price * item.qty;
      });

      message += "\nTotal: ‚Çπ" + total;

      window.open(
        "https://wa.me/919807439655?text=" +
        encodeURIComponent(message),
        "_blank"
      );
    }

    function searchProducts() {
      const value = document.getElementById("searchBox").value.toLowerCase();
      document.querySelectorAll("#product-table-body tr").forEach(row => {
        row.style.display = row.children[0].innerText
          .toLowerCase()
          .includes(value)
          ? ""
          : "none";
      });
    }
  </script>
</head>

<body onload="loadProducts()">

  <h3>üõçÔ∏è Our Products & Prices</h3>

  <input
    type="text"
    id="searchBox"
    placeholder="üîç Search product"
    onkeyup="searchProducts()"
  />

  <table>
    <tr>
      <th>Product Name</th>
      <th>Price</th>
      <th>Quantity</th>
    </tr>
    <tbody id="product-table-body"></tbody>
  </table>

  <div class="cart-box">
    <h3>üõí Your Cart</h3>
    <div id="cart-items"></div>

    <p><strong>Total: ‚Çπ <span id="cart-total">0</span></strong></p>

    <button class="whatsapp-btn" onclick="placeOrderFromCart()">
      Place Your Order
    </button>
  </div>

</body>
</html>
